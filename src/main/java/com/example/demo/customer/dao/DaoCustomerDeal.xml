<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.customer.dao.DaoCustomerDeal">
	<select id="SelectCustomerDeals" resultType="java.util.Map" parameterType="java.util.Map">
		SELECT b.CUSTOMER_DEAL_ID
		     , b.OPEN_YN
		  FROM TB_COURSES a
		     , TB_CUSTOMER_DEALS b
		 WHERE 1=1
		   AND b.COURSE_ID = a.COURSE_ID
		 <if test="CUSTOMER_ID != null">
		   AND a.WRITER_ID = #{CUSTOMER_ID}
		 </if>
		<if test="COURSE_ID != null">
			AND a.COURSE_ID   = #{COURSE_ID}
		</if>
		<if test="CUSTOMER_DEAL_ID != null">
			AND b.CUSTOMER_DEAL_ID = #{CUSTOMER_DEAL_ID}
		</if>
	</select>

	<insert id="InsertCustomerDeal" parameterType="java.util.Map">
		INSERT INTO TB_CUSTOMER_DEALS (
		COURSE_ID
		)
		VALUES (
		#{COURSE_ID}
		)
	</insert>

	<delete id="DeleteCustomerDeal" parameterType="java.util.Map">
		DELETE FROM TB_CUSTOMER_DEALS
		WHERE COURSE_ID        = #{COURSE_ID}
		AND   CUSTOMER_DEAL_ID = #{CUSTOMER_DEAL_ID}
	</delete>


	<select id="SelectCourses" resultType="java.util.Map" parameterType="java.util.Map">
		SELECT a.COURSE_ID
		,      IFNULL(a.COURSE_NM, '새 코스') AS COURSE_NM
		,      a.WRITER_ID
		FROM   TB_COURSES a
		WHERE  1=1
		<if test="WRITER_ID != null">
			AND   a.WRITER_ID = #{WRITER_ID}
		</if>
		<if test="COURSE_ID != null">
			AND   a.COURSE_ID = #{COURSE_ID}
		</if>
		<if test="POPULAR_YN != null">
			AND   a.POPULAR_YN = #{POPULAR_YN}
		</if>
	</select>

	<insert id="InsertCourse" parameterType="java.util.Map">
		INSERT INTO TB_COURSES
		(
			WRITER_ID
		)
		VALUES
		(
		    #{WRITER_ID}
		)
	</insert>

	<update id="UpdateCourse" parameterType="java.util.Map">
		UPDATE TB_COURSES
		   SET COURSE_NM = #{COURSE_NM}
		 WHERE COURSE_ID = #{COURSE_ID}
	</update>

	<delete id="DeleteCourse" parameterType="java.util.Map">
		DELETE FROM TB_COURSES
		WHERE COURSE_ID = #{COURSE_ID}
	</delete>
</mapper>